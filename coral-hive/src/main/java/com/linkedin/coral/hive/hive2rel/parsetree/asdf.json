SELECT NAMED_STRUCT('memberId', farodb_preprod_kafka_streaming_learningbrowseimpressionevent_obfuscateMemberIdNumeric(header.memberId, '{\"fieldPathComponent\":\"memberId\",\"type\":\"PRIMITIVE\",\"dataType\":\"integer\",\"fieldCompliances\":[{\"nonOwner\":false,\"securityClassification\":\"LIMITED_DISTRIBUTION\",\"fieldFormat\":\"NUMERIC\",\"dataType\":\"MEMBER_ID\",\"readonly\":true,\"containingPersonalData\":true,\"fieldPath\":\"header.memberId\",\"pegasusFieldPath\":\"\/header\/memberId\"}],\"pii\":true}'), 'viewerUrn', farodb_preprod_kafka_streaming_learningbrowseimpressionevent_obfuscateAll(header.viewerUrn, '{\"fieldPathComponent\":\"viewerUrn[type=string]\",\"type\":\"PRIMITIVE\",\"dataType\":\"varchar\",\"fieldCompliances\":[{\"nonOwner\":false,\"securityClassification\":\"LIMITED_DISTRIBUTION\",\"fieldFormat\":\"URN\",\"dataType\":\"MEMBER_ID\",\"readonly\":true,\"containingPersonalData\":true,\"fieldPath\":\"header.viewerUrn[type=string]\",\"pegasusFieldPath\":\"\/header\/viewerUrn\/string\"}],\"pii\":true}'), 'applicationViewerUrn', farodb_preprod_kafka_streaming_learningbrowseimpressionevent_obfuscateAll(header.applicationViewerUrn, '{\"fieldPathComponent\":\"applicationViewerUrn[type=string]\",\"type\":\"PRIMITIVE\",\"dataType\":\"varchar\",\"fieldCompliances\":[{\"nonOwner\":false,\"valuePattern\":\"urn:li:sales:\\\\((\\\\d+),\\\\d+,\\\\d+\\\\)\",\"securityClassification\":\"LIMITED_DISTRIBUTION\",\"fieldFormat\":\"CUSTOM\",\"dataType\":\"MEMBER_ID\",\"readonly\":true,\"containingPersonalData\":true,\"fieldPath\":\"header.applicationViewerUrn[type=string]\",\"pegasusFieldPath\":\"\/header\/applicationViewerUrn\/string\"},{\"nonOwner\":false,\"securityClassification\":\"LIMITED_DISTRIBUTION\",\"fieldFormat\":\"URN\",\"dataType\":\"SLIDESHARE_USER_ID\",\"readonly\":true,\"containingPersonalData\":true,\"fieldPath\":\"header.applicationViewerUrn[type=string]\",\"pegasusFieldPath\":\"\/header\/applicationViewerUrn\/string\"},{\"nonOwner\":false,\"securityClassification\":\"LIMITED_DISTRIBUTION\",\"fieldFormat\":\"URN\",\"dataType\":\"ENTERPRISE_PROFILE_ID\",\"readonly\":true,\"containingPersonalData\":true,\"fieldPath\":\"header.applicationViewerUrn[type=string]\",\"pegasusFieldPath\":\"\/header\/applicationViewerUrn\/string\"},{\"nonOwner\":false,\"securityClassification\":\"LIMITED_DISTRIBUTION\",\"fieldFormat\":\"URN\",\"dataType\":\"MEMBER_ID\",\"readonly\":true,\"containingPersonalData\":true,\"fieldPath\":\"header.applicationViewerUrn[type=string]\",\"pegasusFieldPath\":\"\/header\/applicationViewerUrn\/string\"},{\"nonOwner\":false,\"valuePattern\":\"urn:li:(?:contractSeat|ts_contract_seat):\\\\(urn:li:(?:ts_)?contract:(\\\\d+),urn:li:(?:ts_)?seat:\\\\d+\\\\)\",\"securityClassification\":\"LIMITED_DISTRIBUTION\",\"fieldFormat\":\"CUSTOM\",\"dataType\":\"CONTRACT_ID\",\"readonly\":true,\"containingPersonalData\":false,\"fieldPath\":\"header.applicationViewerUrn[type=string]\",\"pegasusFieldPath\":\"\/header\/applicationViewerUrn\/string\"},{\"nonOwner\":false,\"valuePattern\":\"urn:li:(?:contractSeat|ts_contract_seat):\\\\(urn:li:(?:ts_)?contract:\\\\d+,urn:li:(?:ts_)?seat:(\\\\d+)\\\\)\",\"securityClassification\":\"LIMITED_DISTRIBUTION\",\"fieldFormat\":\"CUSTOM\",\"dataType\":\"SEAT_ID\",\"readonly\":true,\"containingPersonalData\":true,\"fieldPath\":\"header.applicationViewerUrn[type=string]\",\"pegasusFieldPath\":\"\/header\/applicationViewerUrn\/string\"}],\"pii\":true}'), 'csUserUrn', header.csUserUrn, 'time', header.time, 'server', header.server, 'service', header.service, 'environment', header.environment, 'guid', header.guid, 'treeId', header.treeId, 'requestId', header.requestId, 'impersonatorId', header.impersonatorId, 'version', header.version, 'instance', header.instance, 'appName', header.appName, 'testId', header.testId, 'testSegmentId', header.testSegmentId, 'auditHeader', header.auditHeader, 'pageInstance', header.pageInstance, 'clientApplicationInstance', header.clientApplicationInstance, 'originSource', header.originSource, 'sessionUrn', farodb_preprod_kafka_streaming_learningbrowseimpressionevent_obfuscateAll(header.sessionUrn, '{\"fieldPathComponent\":\"sessionUrn[type=string]\",\"type\":\"PRIMITIVE\",\"dataType\":\"varchar\",\"fieldCompliances\":[{\"nonOwner\":true,\"securityClassification\":\"HIGHLY_CONFIDENTIAL\",\"dataType\":\"UNSTRUCTURED_PII\",\"readonly\":true,\"containingPersonalData\":true,\"fieldPath\":\"header.sessionUrn[type=string]\",\"pegasusFieldPath\":\"\/header\/sessionUrn\/string\"}],\"pii\":true}'), 'traceData', header.traceData, 'clientMonitoringInstanceId', header.clientMonitoringInstanceId, 'clientMonitoringInstanceEventNumber', header.clientMonitoringInstanceEventNumber, 'originalClientTime', header.originalClientTime, 'clientGlobalSequenceNumber', header.clientGlobalSequenceNumber) AS header, NAMED_STRUCT('browserId', farodb_preprod_kafka_streaming_learningbrowseimpressionevent_obfuscateAll(requestHeader.browserId, '{\"fieldPathComponent\":\"browserId[type=string]\",\"type\":\"PRIMITIVE\",\"dataType\":\"varchar\",\"fieldCompliances\":[{\"nonOwner\":false,\"securityClassification\":\"CONFIDENTIAL\",\"dataType\":\"COOKIE_BEACON_BROWSER_ID\",\"readonly\":true,\"containingPersonalData\":true,\"fieldPath\":\"requestHeader.browserId[type=string]\",\"pegasusFieldPath\":\"\/requestHeader\/browserId\/string\"}],\"pii\":true}'), 'sessionId', farodb_preprod_kafka_streaming_learningbrowseimpressionevent_obfuscateAll(requestHeader.sessionId, '{\"fieldPathComponent\":\"sessionId[type=string]\",\"type\":\"PRIMITIVE\",\"dataType\":\"varchar\",\"fieldCompliances\":[{\"nonOwner\":false,\"securityClassification\":\"CONFIDENTIAL\",\"dataType\":\"COOKIE_BEACON_BROWSER_ID\",\"readonly\":true,\"containingPersonalData\":true,\"fieldPath\":\"requestHeader.sessionId[type=string]\",\"pegasusFieldPath\":\"\/requestHeader\/sessionId\/string\"}],\"pii\":true}'), 'ip', farodb_preprod_kafka_streaming_learningbrowseimpressionevent_obfuscateAll(requestHeader.ip, '{\"fieldPathComponent\":\"ip[type=string]\",\"type\":\"PRIMITIVE\",\"dataType\":\"varchar\",\"fieldCompliances\":[{\"nonOwner\":false,\"securityClassification\":\"CONFIDENTIAL\",\"dataType\":\"IP_ADDRESS\",\"readonly\":true,\"containingPersonalData\":true,\"fieldPath\":\"requestHeader.ip[type=string]\",\"pegasusFieldPath\":\"\/requestHeader\/ip\/string\"}],\"pii\":true}'), 'pageKey', requestHeader.pageKey, 'path', requestHeader.path, 'locale', requestHeader.locale, 'interfaceLocale', requestHeader.interfaceLocale, 'trackingCode', requestHeader.trackingCode, 'referer', farodb_preprod_kafka_streaming_learningbrowseimpressionevent_obfuscateAll(requestHeader.referer, '{\"fieldPathComponent\":\"referer[type=string]\",\"type\":\"PRIMITIVE\",\"dataType\":\"varchar\",\"fieldCompliances\":[{\"nonOwner\":false,\"securityClassification\":\"LIMITED_DISTRIBUTION\",\"dataType\":\"PROFILE_URL\",\"readonly\":true,\"containingPersonalData\":true,\"fieldPath\":\"requestHeader.referer[type=string]\",\"pegasusFieldPath\":\"\/requestHeader\/referer\/string\"}],\"pii\":true}'), 'userAgent', requestHeader.userAgent, 'ipAsBytes', farodb_preprod_kafka_streaming_learningbrowseimpressionevent_obfuscateAll(requestHeader.ipAsBytes, '{\"fieldPathComponent\":\"ipAsBytes[type=com.linkedin.events.IPAddress]\",\"type\":\"PRIMITIVE\",\"dataType\":\"varbinary\",\"fieldCompliances\":[{\"nonOwner\":false,\"securityClassification\":\"CONFIDENTIAL\",\"dataType\":\"IP_ADDRESS\",\"readonly\":true,\"containingPersonalData\":true,\"fieldPath\":\"requestHeader.ipAsBytes[type=com.linkedin.events.IPAddress]\",\"pegasusFieldPath\":\"\/requestHeader\/ipAsBytes\/com.linkedin.events.IPAddress\"}],\"pii\":true}'), 'requestProtocol', requestHeader.requestProtocol, 'requestDomain', requestHeader.requestDomain, 'theme', requestHeader.theme) AS requestHeader, NAMED_STRUCT('osName', mobileHeader.osName, 'osVersion', mobileHeader.osVersion, 'deviceModel', mobileHeader.deviceModel, 'appVersion', mobileHeader.appVersion, 'advertiserId', farodb_preprod_kafka_streaming_learningbrowseimpressionevent_obfuscateAll(mobileHeader.advertiserId, '{\"fieldPathComponent\":\"advertiserId[type=string]\",\"type\":\"PRIMITIVE\",\"dataType\":\"varchar\",\"fieldCompliances\":[{\"nonOwner\":false,\"securityClassification\":\"CONFIDENTIAL\",\"dataType\":\"DEVICE_ID_ADVERTISING_ID\",\"readonly\":true,\"containingPersonalData\":true,\"fieldPath\":\"mobileHeader[type=com.linkedin.events.MobileHeader].advertiserId[type=string]\",\"pegasusFieldPath\":\"\/mobileHeader\/com.linkedin.events.MobileHeader\/advertiserId\/string\"}],\"pii\":true}'), 'vendorId', mobileHeader.vendorId, 'isAdTrackingLimited', mobileHeader.isAdTrackingLimited, 'appMarketingVersion', mobileHeader.appMarketingVersion, 'appVendorVersion', mobileHeader.appVendorVersion, 'appVendorVersionShort', mobileHeader.appVendorVersionShort, 'appState', mobileHeader.appState, 'connectionType', mobileHeader.connectionType) AS mobileHeader, rawSearchId AS rawSearchId, query AS query, browseUrn AS browseUrn, searchOrigin AS searchOrigin, results AS results, datepartition AS datepartition FROM kafka_streaming.learningbrowseimpressionevent